{% extends 'stock/base.html' %}

{% block title %}D√©tails de la commande #{{ order.id }}{% endblock %}

{% block content %}
<div class="order-detail">
    <h2>D√©tails de la commande n¬∞ {{ order.id }}</h2>
    <p><strong>Date :</strong> {{ order.date|date:"d/m/Y H:i" }}</p>

    <hr>

    <h3>Informations client</h3>
    <p><strong>Nom :</strong> {{ order.client.nom }}</p>
    <p><strong>Email :</strong> {{ order.client.email }}</p>
    <p><strong>T√©l√©phone :</strong> {{ order.client.telephone }}</p>
    <p><strong>Adresse :</strong> {{ order.client.adresse }}</p>

    <hr>

    <h3>Produits command√©s</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Produit</th>
                <th>Prix unitaire</th>
                <th>Quantit√©</th>
                <th>Sous Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items.all %}
            <tr>
              
                <td>{{ item.product.nom }}</td>
                <td>{{ item.prix_unitaire }} MAD</td>
                <td>{{ item.quantite }}</td>
                <td>{{ item.subtotal }} MAD</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">Aucun produit dans cette commande.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="total-section">
        <tr>
       <td> <strong>Total HT:</strong> {{ order.total }} MAD </td>
       </tr>
      
    </div>
    <div class="total-section">
       <tr>
       <td> <strong>Total TTC:</strong> {{ orderttc|floatformat:2 }} MAD </td>
        </tr>
    </div>
    <hr>

    <div class="actions no-print">
        <a href="{% url 'stock:invoice_pdf' order.id %}" class="btn btn-primary">üßæ Imprimer Facture</a>
        <a href="{% url 'stock:delivery_note_pdf' order.id %}" class="btn btn-secondary">üìÑ Bon de livraison</a>
        <a href="{% url 'stock:order_list' %}" class="btn btn-light">‚Üê Retour √† la liste</a>
    </div>
</div>

<style>
.order-detail {
    max-width: 900px;
    margin: auto;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
}

.order-detail h2, .order-detail h3 {
    margin-bottom: 10px;
    color: #333;
}

.table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

.table th, .table td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: left;
}

.table th {
    background-color: #f0f0f0;
}

.total-section {
    text-align: right;
    font-size: 1.1em;
    margin-top: 10px;
    font-weight: bold;
}

.actions {
    margin-top: 20px;
    display: flex;
    gap: 10px;
}

.actions .btn {
    padding: 8px 12px;
    border-radius: 4px;
    text-decoration: none;
    color: #fff;
    font-size: 14px;
}

.btn-primary { background-color: #007bff; }
.btn-secondary { background-color: #28a745; }
.btn-light { background-color: #6c757d; color: #fff; }

.btn:hover {
    opacity: 0.85;
}

@media print {
    .no-print {
        display: none;
    }
}
</style>
{% endblock %}
